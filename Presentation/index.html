<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>AJAX</title>
	<link href="http://fonts.googleapis.com/css?family=Lato" rel="stylesheet" />
	<link href="Styles/styles.css" rel="stylesheet" />
	<meta name="author" content="Michał Dudak" />
</head>
<body>
	<div id="impress">
		<div id="title" class="step" data-x="3000" data-y="-4000" data-z="-1000" data-scale="6">
			<hgroup>
				<h1>AJAX</h1>
				<h2>Asynchronous JavaScript And XML</h2>
			</hgroup>
		</div>

		<div class="step" data-x="3000" data-y="-2800" data-z="-1000" data-rotate-x="45" data-scale="1.5">
			<p>Michał Dudak</p>
			<p>Future Processing</p>
		</div>

		<div class="step" data-x="9000" data-y="-2000" data-rotate="180">
			<h2>What is AJAX?</h2>
		</div>

		<div class="step" data-x="9000" data-y="-3200" data-rotate="180">
			<div id="ajaxExampleContent"></div>
			<button id="btnLoadExampleContent">AJAX!</button>
		</div>

		<div class="step" data-x="9000" data-y="-4400" data-rotate="-180" data-scale="0.5">
			<iframe width="800" height="600" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/?ie=UTF8&amp;ll=50.30124,18.649616&amp;spn=0.392542,1.014175&amp;t=m&amp;z=11&amp;output=embed"></iframe>
		</div>

		<div class="step" data-x="8150" data-y="-4400" data-rotate="-90">
			<h2>See for yourself</h2>
			<p>open Firebug, Chrome Dev Tools, Fiddler or whatever and play:</p>
			<button id="btnSendRequest">Send async request</button>
		</div>

		<div class="step" data-x="4000">
			<h2>What do I need it for?</h2>
		</div>

		<div class="step" data-x="4000" data-y="550">
			<ul>
				<li>Responsiveness! (imagine Google Maps without AJAX...)</li>
				<li>Reducing traffic</li>
				<li>Improving load times</li>
				<li>It's just cool</li>
			</ul>
		</div>

		<div class="step" data-x="6000" data-y="550">
			<h2>Problems?</h2>
		</div>

		<div class="step" data-x="6000">
			<p>Insignificant.</p>
		</div>

		<div class="step" data-x="7500">
			<h2>How does it work?</h2>
			<p>
				<a href="https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest">XMLHttpRequest</a> - the low-level interface
			</p>
		</div>

		<div class="step" data-x="7500" data-y="1000">
			<h2>How to use it?</h2>
			<p>
				<pre>
var request = new XMLHttpRequest();
request.open("GET", "staticContent.html");
request.setRequestHeader("Accept", "text/plain");
request.onreadystatechange = function() {
  if (request.readyState === 4) {
    console.log(request.responseText);
  }
}
request.send();
				</pre>
			</p>
		</div>

		<div class="step" data-x="9000" data-y="-400">
			<h2>But it's rarely used so raw...</h2>
		</div>

		<div class="step" data-x="9000">
			<h2>Welcome jQuery</h2>
			<p>and one method* to rule them all:<br /><code><a href="http://api.jquery.com/jQuery.ajax/">$.ajax()</a></code></p>
		</div>


		<div class="step" data-x="9000" data-y="50" data-scale="0.02">
			<p>* - and several shorthand helpers</p>
		</div>

		<div class="step" data-x="9000" data-y="1000">
			<h2>Basic usage</h2>
			<pre>
$.ajax({
  type: "GET",
  url: "http://my-site.net/resource",
  data: { param1: "value", param2: "another value" },
  success: function(response) {
    //...
  },
  error: console.log
});
			</pre>
		</div>

		<div class="step" data-x="9000" data-y="2000">
			<h2>Shorthand methods</h2>
			<ul>
				<li><code>$.get()</code></li>
				<li><code>$.post()</code></li>
				<li><code>.load()</code></li>
				<li>...</li>
			</ul>
			<p>
				<a href="http://api.jquery.com/category/ajax/shorthand-methods/">See the documentation</a>
			</p>
		</div>

		<div class="step" data-x="9000" data-y="3000">
			<a href="playground.html">Go to the playground</a>
		</div>

		<div class="step" data-x="8000" data-y="2000" data-rotate="90">
			<h2>Server side</h2>
			<p>
				What to send?
			</p>
			<ul>
				<li>Plain text</li>
				<li>HTML</li>
				<li>XML</li>
				<li>JSON</li>
			</ul>
		</div>

		<div class="step" data-x="7000" data-y="2000" data-rotate-z="90" data-rotate-y="50">
			<h2>ASP.NET and AJAX</h2>
			<ul>
				<li>Web services</li>
				<li>HTTP Handlers</li>
				<li>MVC actions</li>
				<li>WebAPI</li>
				<li>...</li>
			</ul>
		</div>

		<div class="step ajaxSample" data-x="4000" data-y="2000" data-z="-400" data-rotate="90">
			<h2>Web services</h2>
			<ul>
				<li>More than just AJAX, but they're OK to use</li>
				<li>ASMX (simpler) or WCF (more powerful)</li>
			</ul>
			<button data-url="/DateService.asmx/GetTime">Try it!</button>
			<div class="result"></div>
		</div>

		<div class="step" data-x="4000" data-y="3500" data-z="-400" data-rotate="90">
			<h2>Web services - JSON serializer</h2>
			<p>
				The build-in JSON serializer is pretty weak. Use Newtonsoft.JSON library instead.<br />
				<small>Available as nuget package - JSON.NET</small>
			</p>
			<p>Uses weird content negotiation pattern.</p>
		</div>

		<div class="step ajaxSample" data-x="3000" data-y="2000" data-z="-600" data-rotate="90">
			<h2>HTTP Handlers</h2>
			<ul>
				<li>Low level method</li>
				<li>You have a lot of control</li>
				<li>Requires manual response composing</li>
			</ul>
			<button data-url="/CurrentTime.ashx">Try it!</button>
			<div class="result"></div>
		</div>

		<div class="step ajaxSample" data-x="2000" data-y="2000" data-z="-800" data-rotate="90">
			<h2>ASP.NET MVC action</h2>
			<ul>
				<li>For both synchronous and asynchronous requests</li>
				<li>Requires some initial configuration</li>
			</ul>
			<button data-url="/TimeMvc">Try it!</button>
			<div class="result"></div>
		</div>

		<div class="step ajaxSample" data-x="1000" data-y="2000" data-z="-1000" data-rotate="90">
			<h2>WebAPI</h2>
			<ul>
				<li>Framework for building HTTP services</li>
				<li>Very easy to use (after initial config)</li>
			</ul>
			<button data-url="/API/TimeApi">Try it!</button>
			<div class="result"></div>
		</div>

		<div class="step" data-x="1000" data-y="3500" data-z="-1000" data-rotate="90">
			<h2>WebAPI - input parameters handling</h2>
			<ul>
				<li>
					It just sucks a bit<br />
					<small>See <a href="http://encosia.com/using-jquery-to-post-frombody-parameters-to-web-api/">this Encosia post</a> for more details</small>
				</li>
				<li>TL;DR: just use JSON</li>
			</ul>
		</div>

		<div class="step" data-x="1500" data-y="500" data-rotate="180">
			<h2>Security</h2>
			<ul>
				<li>
					No cross-domain requests
					<ul>
						<li>JSONP - JSON with padding</li>
						<li>CORS - cross origin resource sharing (i.e. Access-Control-Allow-Origin header)</li>
						<li>Proxy server</li>
					</ul>
				</li>
				<li>
					ASP.NET Web Services security features
					<ul>
						<li>GET disabled by default (POST requests are safer)</li>
						<li>wrapper 'd' object (>= .NET 3.5)</li>
					</ul>
				</li>
			</ul>
		</div>

		<div class="step" data-x="1500" data-y="-1000">
			<h2>Your turn!</h2>
			<p>Write a to-do list</p>
		</div>

		<div class="step" data-x="2500" data-y="-1000">
			<h2>Available API:</h2>
			<ul class="api">
				<li>
					<code>TodoRepository</code>
					<ul>
						<li><code>IEnumerable&lt;Todo&gt; GetAll()</code>: Gets all defined todos</li>
						<li><code>Task Get(Guid id)</code>: Gets a todo by ID</li>
						<li><code>Task Add(string description)</code>: Creates a new todo</li>
						<li><code>void Remove(Guid id)</code>: Deletes a todo from the list</li>
						<li><code>void Update(Todo todo)</code>: Updates a todo</li>
					</ul>
				</li>
				<li>
					<code>Todo</code>
					<ul>
						<li><code>Guid Id</code>: Gets the ID of the todo (unique across the system)</li>
						<li><code>string Description</code>: Gets the description</li>
						<li><code>bool IsCompleted</code>: Gets a value indicating if the todo is completed</li>
					</ul>
				</li>
			</ul>
		</div>

		<div id="overview" class="step" data-x="4500" data-y="-1000" data-scale="10">
		</div>
	</div>

	<script src="Scripts/jquery.js"></script>
	<script src="Scripts/impress.js"></script>
	<script>
		impress().init();

		$("#btnLoadExampleContent").click(function() {
			$("#ajaxExampleContent").load("/staticContent.html");
		});

		$("#btnSendRequest").click(function() {
			$.ajax("/staticContent.html");
		});

		$(".ajaxSample button").click(function() {
			var button = $(this);
			var url = button.data("url");
			var resultPanel = button.closest(".ajaxSample").find(".result");

			$.ajax({
				url: url,
				type: "POST",
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json"
			}).done(function(response) {
				var data = response.d || response;
				resultPanel.text(data);
			});
		});
	</script>
</body>
</html>
